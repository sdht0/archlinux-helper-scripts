# Maintainer: Limao Luo <luolimao+AUR@gmail.com>
# Contributor: sausageandeggs <sausageandeggs@archlinux.us>
# Contributor: Martin Herndl <martin.herndl@gmail.com>

_pkgname=guayadeque
pkgname=$_pkgname-git
pkgver=1890
pkgrel=1
pkgdesc="Full Featured Linux media player for large collections"
arch=('i686' 'x86_64')
url='http://sourceforge.net/projects/$_pkgname'
license=('GPL3')
depends=('curl' 'desktop-file-utils' 'flac' 'libgpod' 'taglib' 'wxgtk2.8')
makedepends=('cmake' 'subversion')
optdepends=('gstreamer0.10-plugins: all Gstreamer plugins to play all kind of music files'
            'gvfs: Support for external devices')
provides=($_pkgname $_pkgname-svn)
conflicts=($_pkgname $_pkgname-svn)
install=$_pkgname.install
source=("git+file:///home/lfiles/sources/guayadeque?branch=qt-rewrite")
md5sums=('SKIP')

pkgver() {
    cd "$srcdir/$_pkgname"
    echo r$(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

build() {
    cd "$srcdir/$_pkgname"

    CXXFLAGS="$CXXFLAGS -Wno-unused-local-typedefs"

    cmake . \
        -DCMAKE_BUILD_TYPE='Debug' \
        -DCMAKE_INSTALL_PREFIX='/usr' \
        -DwxWidgets_wxrc_EXECUTABLE='/usr/bin/wxrc-2.8' \
        -DwxWidgets_CONFIG_EXECUTABLE='/usr/bin/wx-config-2.8'
    make
}

package() {
    cd "$srcdir/$_pkgname"
    make DESTDIR="$pkgdir" install
}
