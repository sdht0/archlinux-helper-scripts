# $Id: PKGBUILD 200685 2013-12-02 11:59:05Z svenstaro $
# Maintainer: Andrea Scarpino <andrea@archlinux.org>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

pkgname=cmake-git
_pkgname=cmake
pkgver=3.0.r23585.c4c6427
pkgrel=1
pkgdesc="A cross-platform open-source make system"
arch=('i686' 'x86_64')
url="http://www.cmake.org/"
license=('custom')
depends=('curl' 'libarchive' 'shared-mime-info')
makedepends=('git')
#install="${_pkgname}.install"
source=("git://cmake.org/cmake.git")
md5sums=('SKIP')

pkgver() {
  cd "$srcdir/$_pkgname"
  echo "3.0.r$(git rev-list --count HEAD).$(git rev-parse --short HEAD)"
}

build() {
  cd ${_pkgname}

  ./bootstrap --prefix=/opt/kf5 \
    --parallel=$(/usr/bin/getconf _NPROCESSORS_ONLN)
  make
}

package() {
  cd ${_pkgname}
  make DESTDIR="${pkgdir}" install
}
