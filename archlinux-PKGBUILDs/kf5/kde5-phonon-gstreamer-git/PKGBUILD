# Contributor: Lukas Jirkovsky <l.jirkovsky@gmail.com>
# Contributor: Jekyll Wu <adaptee at gmail dot com>
# Contributor: Xavion <Xavion (dot) 0 (at) Gmail (dot) com>
# Contributor: Rick W. Chen <stuffcorpse@archlinux.us>
# Contributor: Pierre Schmitz <pierre@archlinux.de>
# Contributor: Marek Kubica <marek@xivilization.net>

pkgname=kde5-phonon-gstreamer-git
pkgver=v4.7.1.7.g86c55f5
pkgrel=1
pkgdesc="GStreamer backend for phonon, the multimedia API of KDE."
arch=("i686" "x86_64")
url="https://projects.kde.org/projects/kdesupport/phonon/phonon-gstreamer"
license=("LGPL")
depends=("kde5-phonon-qt5-git" "gstreamer0.10")
makedepends=("pkg-config" "cmake-git" "automoc4" "git")
provides=('phonon-gstreamer-git')
conflicts=('phonon-gstreamer-git')
install="phonon-gstreamer.install"
source=("phonon-gstreamer::git://anongit.kde.org/phonon-gstreamer")
md5sums=('SKIP')

pkgver() {
  cd "$srcdir/phonon-gstreamer"
  git describe --always | sed 's|-|.|g'
}

build() {
  cd "$srcdir/phonon-gstreamer"
  /opt/kf5/bin/cmake . \
    -DCMAKE_INSTALL_PREFIX=/opt/kf5 \
    -DCMAKE_BUILD_TYPE=Debug \
    -DCMAKE_SKIP_RPATH=ON \
    -DCMAKE_INSTALL_LIBDIR=lib \
    -DPHONON_BUILD_PHONON4QT5=ON
  make
}


package () {
  cd "$srcdir/phonon-gstreamer"
  make DESTDIR="$pkgdir" install
}

